
# i0 Hardened Base Docker Images

This repository contains Dockerfiles and releases of hardened i0 Base Docker Images.

[![Publish Base Docker images](https://github.com/interrzero/base-docker-images/actions/workflows/publish-base-images.yml/badge.svg)](https://github.com/interrzero/base-docker-images/actions/workflows/publish-base-images.yml) [![Repository Release Date](https://img.shields.io/github/release-date/interrzero/base-docker-images?label=Repository%20Release%20Date&style=for-the-badge&logo=calendar)](https://github.com/interrzero/base-docker-images/releases/latest)

![Many Dockerfiles](dockerfiledotfinaldotv2dotfinallyfinal-v0-l7sfec8j2v5e1.png.webp)

## WiP

This repository is a work in progress, but the produced images are considered stable, unless otherwise noted below.

## Available Images

[![FIPS Base](https://img.shields.io/github/v/tag/interrzero/base-docker-images?filter=release/fips-base/*&label=fips-base&style=for-the-badge&logo=lock&color=red)](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Ffips-base)
<<<<<<< HEAD
[![Go Base](https://img.shields.io/github/v/tag/interrzero/base-docker-images?filter=release/go-base/*&label=go-base&style=for-the-badge&logo=go&color=00ADD8)](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fgo-base)
[![Nginx Base](https://img.shields.io/github/v/tag/interrzero/base-docker-images?filter=release/nginx-base/*&label=nginx-base&style=for-the-badge&logo=nginx&color=009639)](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fnginx-base)
[![Node.js 24 Base](https://img.shields.io/github/v/tag/interrzero/base-docker-images?filter=release/nodejs-24-base/*&label=nodejs-24-base&style=for-the-badge&logo=nodedotjs&color=339933)](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fnodejs-24-base)
[![OpenJDK 17 Base](https://img.shields.io/github/v/tag/interrzero/base-docker-images?filter=release/openjdk-17-base/*&label=openjdk-17-base&style=for-the-badge&logo=openjdk&color=ED8B00)](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fopenjdk-17-base)
[![Python 3.13 Base](https://img.shields.io/github/v/tag/interrzero/base-docker-images?filter=release/python-3.13-base/*&label=python-3.13-base&style=for-the-badge&logo=python&color=3776AB)](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fpython-3.13-base)
[![Wolfi Base](https://img.shields.io/github/v/tag/interrzero/base-docker-images?filter=release/wolfi-base/*&label=wolfi-base&style=for-the-badge&logo=linux&color=FCC624)](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fwolfi-base)

### Latest linux/amd64 Releases

* [fips-base-linux-amd64](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Ffips-base-linux-amd64)
* [go-base-linux-amd64](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fgo-base-linux-amd64)
* [nginx-base-linux-amd64](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fnginx-base-linux-amd64)
* [nodejs-24-base-linux-amd64](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fnodejs-24-base-linux-amd64)
* [openjdk17-base-linux-amd64](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fopenjdk17-base-linux-amd64)
* [python-3.13-base-linux-amd64](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fpython-3.13-base-linux-amd64)
* [wolfi-base-linux-amd64](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fwolfi-base-linux-amd64)

### Latest linux/arm64 Releases

* [fips-base-linux-arm64](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Ffips-base-linux-arm64)
* [go-base-linux-arm64](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fgo-base-linux-arm64)
* [nginx-base-linux-arm64](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fnginx-base-linux-arm64)
* [nodejs-24-base-linux-arm64](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fnodejs-24-base-linux-arm64)
* [openjdk17-base-linux-arm64](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fopenjdk17-base-linux-arm64)
* [python-3.13-base-linux-arm64](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fpython-3.13-base-linux-arm64)
* [wolfi-base-linux-arm64](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fwolfi-base-linux-arm64)
=======

[![Go Base](https://img.shields.io/github/v/tag/interrzero/base-docker-images?filter=release/go-base/*&label=go-base&style=for-the-badge&logo=go&color=00ADD8)](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fgo-base)

[![Nginx Base](https://img.shields.io/github/v/tag/interrzero/base-docker-images?filter=release/nginx-base/*&label=nginx-base&style=for-the-badge&logo=nginx&color=009639)](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fnginx-base)

[![Node.js Base](https://img.shields.io/github/v/tag/interrzero/base-docker-images?filter=release/nodejs-base/*&label=nodejs-base&style=for-the-badge&logo=nodedotjs&color=339933)](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fnodejs-base)

[![OpenJDK Base](https://img.shields.io/github/v/tag/interrzero/base-docker-images?filter=release/openjdk17-base/*&label=openjdk17-base&style=for-the-badge&logo=openjdk&color=ED8B00)](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fopenjdk17-base)

[![Python Base](https://img.shields.io/github/v/tag/interrzero/base-docker-images?filter=release/python-base/*&label=python-3.13-base&style=for-the-badge&logo=python&color=3776AB)](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fpython-3.13-base)

[![Wolfi Base](https://img.shields.io/github/v/tag/interrzero/base-docker-images?filter=release/wolfi-base/*&label=wolfi-base&style=for-the-badge&logo=linux&color=FCC624)](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fwolfi-base) 
 
### Latest Language Releases

* [Go](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fgo-base)
* [Node.js](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fnodejs-base)
* [OpenJDK](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fopenjdk17-base)
* [Python](https://github.com/interrzero/base-docker-images/pkgs/container/base-docker-images%2Fpython-3.13-base)
>>>>>>> origin/main

## Hardening

Images are considered hardened when they do not contain fixed CVE vulnerabilities of the following severities: CRITICAL, HIGH, MEDIUM. They are based on [wolfi-base](<https://edu.chainguard.dev/open-source/wolfi/overview/>) from Chainguard. We use Renovate to automatically update each of these base images to the most recently published image ([`latest`](https://edu.chainguard.dev/chainguard/chainguard-images/reference/wolfi-base/tags_history/)).

## Current Language Versions

* **Go**: 1.25.x (from chainguard/go:latest)
* **Node.js**: 24.6.x with npm 11.5.x (from wolfi-base with nodejs/npm packages)
* **Python**: 3.13.x (from wolfi-base with python-3.13 package, pinned to avoid auto-upgrade to 3.14)
  * **Note**: Python 3.14 support will be added once `py3.14-pip` becomes available in the Wolfi package repository
* **OpenJDK**: 17.x with Maven 3.9.8 (from wolfi-base with openjdk-17 package)
* **Wolfi Base**: Latest minimal Linux distribution
* **FIPS Base**: Custom OpenSSL 3.0.9 with FIPS validation ([beta](#beta-images))
* **Nginx**: 1.29.x with headers-more module (custom build)

### Recommended Version Pinning

All images are tagged with `latest` and we recommend that you use this tag in your Dockerfiles. Because language versions are now pinned in our images, using the `:latest` tag ensures that you always have the most recent security patches and updates without introducing breaking changes.

To ensure that your CI/CD pipeline always uses the latest version of the image, you should use the `--pull` flag in your `docker build` command.

## How to Use

### Ensure your base image is always fresh

By default, `docker build` will use a cached version of a base image if it already exists in the build environment. Because our Dockerfiles use the mutable `:latest` tag, there's a risk that your CI/CD pipeline could use a stale base image, potentially missing critical security patches.

To prevent this, you should add the `--pull` flag to your `docker build` command. This flag explicitly tells Docker to always attempt to pull a newer version of the base image from the remote registry before starting the build.

**In your CI/CD pipelines, always use:**

```shell
docker build --pull -t your-app .
```

**In your Dockerfile:**

```dockerfile
FROM ghcr.io/interrzero/base-docker-images/<image-name>:latest
```

### Authenticating to GHCR

While these images are public and can be pulled without authentication, anonymous pulls are subject to stricter rate limits. For use in CI/CD pipelines or for frequent local development, it is highly recommended to authenticate with a Personal Access Token (PAT) to avoid potential rate-limiting issues.

```shell
export CR_PAT=YOUR_TOKEN
$ echo $CR_PAT | docker login ghcr.io -u USERNAME --password-stdin
> Login Succeeded
```

### Use Base Image in Your Project

All currently available images are [listed here](https://github.com/orgs/interrzero/packages?repo_name=base-docker-images).

To use an image in your project, you can use the following snippet:

```shell
FROM ghcr.io/interrzero/base-docker-images/<docker-image-name>:<tag>
```

Anyone can pull the image locally with their Github [personal access token](https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-container-registry#authenticating-to-the-container-registry).

### Beta images

The beta images are tested within limited scope and are generally stable but not recommended for production use without thorough testing in lower environments.  We encourage you to use them for testing and development and provide feedback to us to help us get them to GA faster.  If any bugs or unexpected behaviors are encountered, please open an issue using the BUG_REPORT template in this repository with enough detail to reproduce the issue.

#### FIPS-enabled base image

The image built from the [Dockerfile.fips-base](./Dockerfile.fips-base) includes FIPS-enabled OpenSSL and the Dockerfile shows an example of how to use it in the `Example Stage 2` section that should be modified to your workload's specific needs.

[More information on the FIPS image.](./FIPS.md)

### Nginx Security

#### Overview

If you are using the nginx image provided in this repository, you should also use the `nginx.conf` file in this repository if you need to make any changes to it.  In most cases, you should not need to make any changes to the nginx configuration as it is already matching configuration set up in the container.

Starting nginx as user `root`

The nginx server in the nginx image should be run as user `nginx` for security reasons, but the server can also be started as user `root` in situations where nginx needs to bind to ports <= 1024, i.e. `0.0.0.0:80`.  In those scenarios nginx parent process will be started as `root`, then drop privileges when starting worker processes by switching to user `nginx`.
This mode of operation requires that the following stanza at the top of the [`nginx.conf`](./nginx.conf) config file is uncommented and looks as follows:

```shell
    user nginx;
```

#### Your nginx Container

Running nginx unprivileged, on ports > 1024:

      PID   USER     TIME  COMMAND
      1 nginx     0:00 nginx: master process /usr/sbin/nginx -c /etc/nginx/nginx.conf -e /dev/stderr -g daemon off;
      7 nginx     0:00 nginx: worker process
      8 nginx     0:00 nginx: worker process
      9 nginx     0:00 nginx: worker process
     10 nginx     0:00 nginx: worker process
     11 nginx     0:00 /bin/sh
    232 nginx     0:00 ps aux

Running on lower ports as user `root` and worker processes running as user `nginx` after starting the container, will look similar to the below:

    PID   USER     TIME  COMMAND
      1 root      0:00 nginx: master process /usr/sbin/nginx -c /etc/nginx/nginx.conf -e /dev/stderr -g daemon off;
      8 nginx     0:00 nginx: worker process
      9 nginx     0:00 nginx: worker process
     10 nginx     0:00 nginx: worker process
     11 nginx     0:00 nginx: worker process
     12 root      0:00 /bin/sh
     18 root      0:00 ps aux

Please see the <a href="examples/">examples</a> directory for an example nginx workload <A href="examples/default.conf">configuration</a> file and the corresponding <a href="examples/Dockerfile.example.nginx">Dockerfile</a>.

### Go Application Development

For Go applications, see the <a href="examples/">examples</a> directory for a simple Go hello world example and the corresponding <a href="examples/Dockerfile.example.go">Dockerfile</a> that.

## Contributing

### Add New Image

PR to `main` with new Dockerfile in format `Dockerfile.<image-name>`. This will build your Docker image with semver tag `0.0.1`.

### Update Image

1. Merge PR to main.
2. Workflow will diff which Dockerfiles changed and create release tags for them.
3. Workflow triggered by creation of new release tag will build new Docker image, incrementing the patch version and setting it to `latest`.

### Rebuild an Image Manually

To trigger a rebuild of an image, for example to pick up the latest security patches from the base image, you can make a trivial change to the corresponding `Dockerfile.<image-name>` file. For example, you can add a comment to the Dockerfile.

Then, create a pull request with your change targeting the `main` branch. Once the pull request is merged, the "Update Image" workflow will be triggered, and a new version of the image will be built and published.

